name: Build release zips (manual test)

on:
  push:
    branches:
      - new_apworld

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      # 1️⃣ Create spelunky2.apworld from .spelunky2 contents
      - name: Prepare spelunky2.apworld
        run: |
          mkdir spelunky2
          cp -r .spelunky2/* spelunky2/
          zip -r spelunky2.apworld spelunky2

      # 2️⃣ Create Spelunky2-Client.zip from everything else
      - name: Prepare Spelunky2-Client.zip
        run: |
          mkdir client
          shopt -s extglob
          cp -r !( .spelunky2|.git|.github|client ) client/
          cd client
          zip -r ../Spelunky2-Client.zip .

      # 3️⃣ Upload both as downloadable artifacts (instead of attaching to a release)
      - name: Upload test artifacts
        uses: actions/upload-artifact@v4
        with:
          name: spelunky2-zips
          path: |
            spelunky2.apworld
            Spelunky2-Client.zip
